name: Welcome Closed - Create Step 1

on:
  issues:
    types: [closed]

permissions:
  contents: read
  issues: write

jobs:
  create-step-1:
    name: Create Step 1 Issue
    runs-on: ubuntu-latest
    if: contains(github.event.issue.title, 'Welcome to GitHub MCP Workflow Demo')
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Check if step 1 issue already exists
        id: check-step1
        run: |
          issue_number=$(gh issue list --search "Step 1: Fix the CSS Bug in:title" --state open --json number --jq '.[0].number')
          if [ -z "$issue_number" ]; then
            echo "exists=false" >> $GITHUB_OUTPUT
          else
            echo "exists=true" >> $GITHUB_OUTPUT
          fi
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: Create Step 1 issue
        if: steps.check-step1.outputs.exists == 'false'
        run: |
          cat > step1-body.md << 'EOF'
## Step 1: Fix the CSS Bug ğŸ›

Great job setting up! Now let's fix the broken CSS link in the World Clock application.

### ğŸ¯ Your Mission

Fix the CSS stylesheet link in `index.html` so the World Clock displays with proper styling.

### ğŸ” The Problem

The file `index.html` has a typo on line 7:
```html
<link rel="stylesheet" href="styls.css">
```

It should be:
```html
<link rel="stylesheet" href="styles.css">
```

### ğŸ“‹ Instructions

1. **Create a new branch** for your fix:
   ```bash
   git checkout -b fix-css-link
   ```

2. **Open `index.html`** and fix the typo on line 7

3. **Save, commit, and push**:
   ```bash
   git add index.html
   git commit -m "Fix CSS stylesheet link typo"
   git push -u origin fix-css-link
   ```

### âœ… Success Criteria

- CSS link changed from `styls.css` to `styles.css`
- Changes committed and pushed to a branch

Once you push your changes, I'll automatically validate your fix!

---

ğŸ’¡ **Tip**: You can also ask GitHub Copilot for help: "Can you fix the CSS link in index.html?"
EOF
          gh issue create \
            --title "Step 1: Fix the CSS Bug ğŸ›" \
            --body-file step1-body.md
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
